import { Meta, Story, Preview, Props } from '@storybook/addon-docs/blocks';
import { State, Store } from "@sambego/storybook-state";
import { action } from '@storybook/addon-actions';

import Playhead from './playhead/Playhead';
import Slider from './slider/Slider';
import Timeline from './Timeline';

import data from './timeline.data.json';

export const plainTimelineStore = new Store({
  currentTime: 50,
  duration: 1000,
});
export const richTimelineStore = new Store({
  currentTime: 50,
  duration: 1000,
});
export const playheadStore = new Store({
  currentTime: 0,
  duration: 10000,
});

export const onPlainTimelineChange = (newTime) => {
  action('onTimelineChange')(newTime);
  plainTimelineStore.set({ currentTime: newTime });
}
export const onRichTimelineChange = (newTime) => {
  action('onTimelineChange')(newTime);
  richTimelineStore.set({ currentTime: newTime });
}
export const onPlayheadChange = (newTime) => {
  action('onPlayheadChange')(newTime);
  playheadStore.set({ currentTime: newTime });
}

<Meta title="Timeline"  />

# Timeline

## Plain

<Preview>
  <Story name="Plain">
    <State store={plainTimelineStore}>
      {state =>
        <Timeline
          duration={state.duration}
          onChange={onPlainTimelineChange}
        />
      }
     </State>
  </Story>
</Preview>

## Rich

<Preview>
  <Story name="Rich">
    <State store={richTimelineStore}>
      {state =>
        <Timeline
          currentTime={state.currentTime}
          data={data}
          duration={state.duration}
          onChange={onRichTimelineChange}
        />
      }
     </State>
  </Story>
</Preview>

## Props

<Props of={Timeline} />

# Partials

## Playhead

<Preview>
  <Story name="Partials » Playhead">
    <State store={playheadStore}>
      {state =>
        <Playhead
          currentTime={state.currentTime}
          duration={state.duration}
          onChange={onPlayheadChange}
        />
      }
     </State>
  </Story>
</Preview>

## Slider

<Preview>
  <Story name="Partials » Slider (Clips)">
    <Slider
      checkInstance={action('checkInstance')}
      deleteInstance={action('deleteInstance')}
      extendInstance={action('extendInstance')}
      updateInstance={action('updateInstance')}
      duration={100}
      instances={[
        {
          end_seconds: 50,
          id: 2,
          start_seconds: 30,
        },
        {
          end_seconds: 90,
          id: 3,
          start_seconds: 70,
        },
      ]}
      onDrag={action('onDrag')}
      onDragEnd={action('onDragEnd')}
      onDragStart={action('onDragStart')}
    />
  </Story>
</Preview>

<Preview>
  <Story name="Partials » Slider (Tags)">
    <Slider
      clipInstance={action('clipInstance')}
      deleteInstance={action('deleteInstance')}
      extendInstance={action('extendInstance')}
      updateInstance={action('updateInstance')}
      duration={100}
      instances={[
        {
          end_seconds: 50,
          id: 2,
          start_seconds: 30,
        },
        {
          end_seconds: 90,
          id: 3,
          start_seconds: 70,
        },
      ]}
      onDrag={action('onDrag')}
      onDragEnd={action('onDragEnd')}
      onDragStart={action('onDragStart')}
    />
  </Story>
</Preview>
